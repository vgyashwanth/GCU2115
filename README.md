README
This repository contains the firmware [application layer (APL), hardware abstraction layer (HAL) and the middleware (MW)] for MnM GC2115 R1.

Prerequisites
For building the code
Go through the steps mentioned below and refer to the attached video for setting up your workspace.
e2studio IDE \ Note: The link provided is for the latest version of e2studio. But, the current team members use an older version - 2021-01 (21.1.0). The setup for this version can be found at the below path:
\\smplnas\Engineering\Official\Functions\OHSW\Records\Renesas.
Press (Windows key + R) and paste this path to access the files.
When e2studio is being installed, it provides an option to choose the toolchain version. The toolchain version used by the current team members is mentioned below and it is advised to use the same:
GCC ARM Embedded Toolchain (version - preferrably 9.2.1 or 10.2.1)
If it is not available in the options provided by e2studio, the setup file can be found at the path mentioned above.
The version of the FSP used by the current team is mentioned below and the setup file for the same can be found at the path mentioned above:
FSP version - 3.2.1
The details for the corresponding board support package (BSP) files of GC2115 R1 can be found here:
Bitbucket project - SW â€“ GC2X
Bitbucket repo - gc2k-bsp
Bitbucket branch - improvement/STB_fault_detection
Bitbucket commit ID - ef947a7
The above details are specific to this release. Refer to the release note for details of other releases.
For flashing the code
Hardware - SM00015046 (with Renesas RA6M2 R7FA6M2AF3CFB microcontroller).
Compatible bootloader - SM0013200- 1.28V with 50% Contrast, SM0015556- 1.28V with 50% Contrast
Compatible GCU Flasher version - D4.2.1.6 or above
Compatible Smart Config - SmartConfig-T V1.0.0.0 or above
Building the project
Open e2studio and click on File --> "Open Projects From File System". Browse for the folder where the repo has been cloned and select "mnm_gc2115\gc2k-bsp\e2s_project (the e2s project file present in the bsp).
Expand the project in the project explorer and open the "configuration.xml" file.
This file helps in updating and generating the hardware specific board support package(BSP) configuration file. Select the appropriate FSP version, board and device . This is pre-configured in the BSP repo. Required changes in the file should be committed in the respective BSP branch.
Click on "Generate Project Content".
The configuration files should have been generated. Now click on "Project" --> "Build All" to build your project.
Every time the project is cleaned and built again, the memory regions (present in the memory_regions.ld file ) are reset. More details and a solution to this problem can be found here - Memory regions reset issue. \ Ensure that the memory regions are properly set before flashing the code onto a device.
The following values can be used for the FLASH_START and FLASH_LENGTH in the memory regions.ld file: * FLASH_START = 0x00010000 * FLASH_LENGTH = 0x80000 (this value can be changed depending on the requirement)
Flashing the code on a device
Once you have obtained the necessary hardware (mentioned above) and software (GCU Flasher version has been mentioned above), use the "JFlash" application to flash the bootloader (version mentioned above).
Open the GCU Flasher app and select the device map, CFGC and CFGZ files from the release package.
The language pack present in the release package can be flashed through the "Ext EEPROM file" section of the GCU Flasher.
If you want to flash the code generated by the e2studio, click on "Browse" for the firmware field --> Open the repo which holds the code --> Open "gc2k-bsp" --> Open "e2s_project" --> "Debug" --> Choose the "gc2k_pcbxxx.srec" file.
Put the device in programming mode (generally done by powering it on while long pressing the "Stop" button).
Flash all the selected files and you are ready to go.
Changing the GCU configuration
Use the appropriate Smartconfig-T version to change the configuration the GCU.
How to enter Debug mode
Connect the J-Link debugger to the device correctly and ensure that the above steps for building the project and followed correctly.
In e2studio, click on Debug --> Debug Configurations --> Renesas GDB Hardware Dbugging --> gc2k_pcbxxx Debug_Flat --> Debugger --> Update the Debug Hardware (to J-Link ARM), Target Device.
Click on Debug --> Debug Configurations --> Renesas GDB Hardware Dbugging --> gc2k_pcbxxx Debug_Flat --> Startup --> Run Commands (add set $pc = 0x10004, set $sp = 0x10000 in consecutive lines). This is to set the program counter and stack pointer. \ Then you can click on "Debug" at the bottom and continue your debugging process.

Contributors
Aditya Joshi
Aditya Kasar
Manohar Varanasi
Ramachandran S